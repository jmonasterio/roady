{"id":"roady-0ln","title":"Eliminate tenant_user_mapping redundancy","description":"Remove redundant tenant_user_mapping documents by extracting role from user.tenants[] array instead. This fixes data consistency issues where role could diverge between mapping doc and user doc.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-09T22:04:03.4834215-08:00","updated_at":"2025-12-09T23:21:16.9886503-08:00","closed_at":"2025-12-09T23:21:16.9886503-08:00"}
{"id":"roady-1eo","title":"Migration: existing tenants to bands","description":"Script to convert existing tenant data to band structure. Rename tenants to bands. Add band names.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T17:59:00.8885706-08:00","updated_at":"2025-12-09T23:21:17.000576-08:00","closed_at":"2025-12-09T23:21:17.000576-08:00"}
{"id":"roady-1xt","title":"Update user and band tenant documents","description":"Add name, ownerId, and roles fields to existing tenant documents. No user document changes needed. Leverage existing tenancy model.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-07T17:58:47.972311-08:00","updated_at":"2025-12-07T18:11:54.0300053-08:00","dependencies":[{"issue_id":"roady-1xt","depends_on_id":"roady-amg","type":"blocks","created_at":"2025-12-07T17:59:08.8651868-08:00","created_by":"daemon"}]}
{"id":"roady-2v0","title":"App layer: band initialization and switching","description":"On init: call /my-tenants to get user's bands. If first time, call /api/tenants/create. Set DB.setTenant() for current band. Load data.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T17:58:54.8236038-08:00","updated_at":"2025-12-09T23:21:17.0046345-08:00","closed_at":"2025-12-09T23:21:17.0046345-08:00"}
{"id":"roady-49y","title":"Phase 1: User doc replication - Add user doc to PouchDB","description":"Replicate user documents from couch-sitter to local PouchDB. Read active_tenant_id from local doc instead of JWT.","status":"open","priority":0,"issue_type":"feature","created_at":"2025-12-10T21:39:26.9593887-08:00","updated_at":"2025-12-10T21:39:26.9593887-08:00"}
{"id":"roady-5lf","title":"Phase 3: Add _changes listener for tenants","description":"Listen to PouchDB _changes feed for tenant documents. Auto-update tenantList and app.userBands on changes.","status":"open","priority":0,"issue_type":"feature","created_at":"2025-12-10T21:39:39.6735424-08:00","updated_at":"2025-12-10T21:39:39.6735424-08:00","dependencies":[{"issue_id":"roady-5lf","depends_on_id":"roady-csr","type":"blocks","created_at":"2025-12-10T21:40:00.0678173-08:00","created_by":"daemon"}]}
{"id":"roady-61v","title":"Handle API failures gracefully in offline/unconnected mode","description":"When backend API (localhost:5985) is unavailable: allow tenant switching, band creation, and all local operations without blocking. JWT issues and choose-tenant failures should not break the app.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-08T20:10:07.93589-08:00","updated_at":"2025-12-08T20:10:07.93589-08:00","dependencies":[{"issue_id":"roady-61v","depends_on_id":"roady-g56","type":"blocks","created_at":"2025-12-08T21:19:31.1182957-08:00","created_by":"daemon"}]}
{"id":"roady-7da","title":"API: Soft delete logic and cascading","description":"Implement soft delete for bands with cascade to equipment, gig types, gigs. Mark documents with deletedAt and deletedBy. Exclude deleted docs in queries.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-07T18:04:21.0415868-08:00","updated_at":"2025-12-07T18:04:47.88482-08:00","closed_at":"2025-12-07T18:04:47.88482-08:00"}
{"id":"roady-894","title":"API: POST /api/tenants endpoints for CRUD","description":"Implement /api/tenants/create, /list, /:bandId/rename, /:bandId/members, /:bandId/invite, /:bandId/delete. All soft deletes with deletedAt marker. Owner-only authorization.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-07T18:04:19.6506876-08:00","updated_at":"2025-12-07T18:04:46.8606377-08:00","closed_at":"2025-12-07T18:04:46.8606377-08:00","dependencies":[{"issue_id":"roady-894","depends_on_id":"roady-e76","type":"blocks","created_at":"2025-12-07T18:04:25.104623-08:00","created_by":"daemon"},{"issue_id":"roady-894","depends_on_id":"roady-7da","type":"blocks","created_at":"2025-12-07T18:04:26.2925479-08:00","created_by":"daemon"}]}
{"id":"roady-93s","title":"Create new band dialog","description":"Modal dialog to create new band. New band = new shared tenant. User becomes owner. Can invite members.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T17:58:51.1686058-08:00","updated_at":"2025-12-07T18:21:06.3023163-08:00","closed_at":"2025-12-07T18:21:06.3023163-08:00"}
{"id":"roady-93t","title":"Band-first approach: Data model and user mental model","description":"Users think in terms of bands, not tenants. Every band = one shared tenant. Original tenant becomes first band. Users can create more bands with separate tenants.","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-07T17:58:41.6575773-08:00","updated_at":"2025-12-09T23:21:16.9930236-08:00","closed_at":"2025-12-09T23:21:16.9930236-08:00","dependencies":[{"issue_id":"roady-93t","depends_on_id":"roady-1xt","type":"blocks","created_at":"2025-12-07T17:59:06.1533264-08:00","created_by":"daemon"},{"issue_id":"roady-93t","depends_on_id":"roady-xyf","type":"blocks","created_at":"2025-12-07T17:59:07.3027277-08:00","created_by":"daemon"},{"issue_id":"roady-93t","depends_on_id":"roady-894","type":"blocks","created_at":"2025-12-07T18:04:24.3941274-08:00","created_by":"daemon"}]}
{"id":"roady-amg","title":"Database layer: band management methods","description":"Add setCurrentBand(), getAllUserBands(), createBand(), updateBandName(), addBandMember() to DB layer.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T17:58:53.6343599-08:00","updated_at":"2025-12-07T18:11:56.8621119-08:00","closed_at":"2025-12-07T18:11:56.8621119-08:00"}
{"id":"roady-arv","title":"Phase 5: Remove HTTP fetching - Cleanup old code","description":"Remove tenantManager.getMyTenants() HTTP call. Remove duplicate userBands sync code. Clean up after phases 1-4.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-10T21:39:52.8323005-08:00","updated_at":"2025-12-10T21:39:52.8323005-08:00","dependencies":[{"issue_id":"roady-arv","depends_on_id":"roady-m6a","type":"blocks","created_at":"2025-12-10T21:40:01.7569208-08:00","created_by":"daemon"}]}
{"id":"roady-axw","title":"Settings page: band management","description":"Display current band, option to rename, show all user's bands, member list, delete band (if solo).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T17:58:52.5980096-08:00","updated_at":"2025-12-07T18:23:09.1335897-08:00","closed_at":"2025-12-07T18:23:09.1335897-08:00"}
{"id":"roady-bo0","title":"Band-first approach: Fix user doc creation and ID format issues","description":"ISSUES DISCOVERED: 1) User documents not being created on login - should be created when /my-tenants is called. 2) MyCouch routing broken - tenant router wasn't being registered before catch-all due to decorator timing. 3) ID format mismatch - auth_middleware returning wrong user_id format. FIXES APPLIED: 1) auth_middleware now hashes sub to create correct user_{hash} format. 2) tenant_routes calls ensure_user_exists before creating tenant. 3) MyCouch router registration moved BEFORE catch-all decorator (line 1532). 4) Simplified user lookup in create_workspace_tenant. NEXT: Restart MyCouch, verify /api/tenants/* routes work, test full band creation flow, verify user docs are created. BLOCKERS: Need to ensure user documents exist in couch-sitter before tenant creation works properly.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-09T07:16:00.6831127-08:00","updated_at":"2025-12-09T07:16:00.6831127-08:00"}
{"id":"roady-csr","title":"Phase 2: Tenant list in PouchDB - Sync and cache tenants","description":"Replicate tenant documents to local PouchDB. Remove HTTP getMyTenants() call. Query from local db instead.","status":"open","priority":0,"issue_type":"feature","created_at":"2025-12-10T21:39:32.8951915-08:00","updated_at":"2025-12-10T21:39:32.8951915-08:00","dependencies":[{"issue_id":"roady-csr","depends_on_id":"roady-49y","type":"blocks","created_at":"2025-12-10T21:39:59.1763239-08:00","created_by":"daemon"}]}
{"id":"roady-d48","title":"Update roady for virtual tables integration","description":"Update PouchDB client to use new __users and __tenants virtual endpoints from mycouch proxy instead of direct user/tenant endpoints","status":"in_progress","priority":1,"issue_type":"feature","created_at":"2025-12-10T07:56:52.9613803-08:00","updated_at":"2025-12-10T08:08:28.9696811-08:00"}
{"id":"roady-duy","title":"Verify mycouch /api/tenants endpoints and soft delete behavior","description":"Confirm /api/tenants endpoints work as expected. Verify soft delete enforcement, cascade behavior, and authorization checks are handled by mycouch backend.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-07T18:04:51.5017669-08:00","updated_at":"2025-12-07T18:05:01.9837905-08:00","closed_at":"2025-12-07T18:05:01.9837905-08:00"}
{"id":"roady-e76","title":"Data model: Add soft delete fields","description":"Add deletedAt and deletedBy to band tenant and content documents. Support deleted marker in equipment, gig types, gigs.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T18:04:22.128624-08:00","updated_at":"2025-12-07T18:08:37.2242051-08:00","closed_at":"2025-12-07T18:08:37.2242051-08:00"}
{"id":"roady-g56","title":"Fix: Clerk JWT token not updating when setting user metadata","description":"FIXED: 1) MyCouch routing - moved tenant router registration before catch-all so /api/tenants/* routes match first. 2) Frontend session sync - after /choose-tenant succeeds, call Clerk.session.reload() then getToken(force:true) to fetch JWT with updated active_tenant_id claim. NEXT: Restart services and test band creation flow end-to-end.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-08T21:19:27.8734187-08:00","updated_at":"2025-12-08T22:11:51.6997802-08:00"}
{"id":"roady-h1f","title":"Feature: Allow deleting shared tenants after removing all members","description":"Currently, users cannot delete a tenant if it has other members. Implement UI to: 1) List members of the tenant, 2) Remove other members, 3) Then allow deletion. This prevents accidental deletion of shared resources.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-09T07:30:33.8704075-08:00","updated_at":"2025-12-09T23:21:16.9969265-08:00","closed_at":"2025-12-09T23:21:16.9969265-08:00"}
{"id":"roady-m6a","title":"Phase 4: Update setActiveTenant to use PouchDB","description":"Change setActiveTenant from PUT /__users endpoint to local PouchDB write. Let sync happen in background.","status":"open","priority":0,"issue_type":"feature","created_at":"2025-12-10T21:39:45.5254464-08:00","updated_at":"2025-12-10T21:39:45.5254464-08:00","dependencies":[{"issue_id":"roady-m6a","depends_on_id":"roady-5lf","type":"blocks","created_at":"2025-12-10T21:40:01.0523915-08:00","created_by":"daemon"}]}
{"id":"roady-xyf","title":"First-time user: auto-create initial band","description":"When new user signs up, automatically create first band (shared tenant) with default name 'My First Band'. No tenant selection dialog.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-07T17:58:49.0317411-08:00","updated_at":"2025-12-07T17:58:49.0317411-08:00","dependencies":[{"issue_id":"roady-xyf","depends_on_id":"roady-2v0","type":"blocks","created_at":"2025-12-07T17:59:10.8003779-08:00","created_by":"daemon"}]}
{"id":"roady-yar","title":"Band selector UI component","description":"Add band switcher to main navigation. Show current band name with dropdown to see all user's bands and create new band.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-07T17:58:50.1908001-08:00","updated_at":"2025-12-07T18:21:00.8297168-08:00","closed_at":"2025-12-07T18:21:00.8297168-08:00"}
{"id":"roady-ypr","title":"Offline-first tenant data: read from MyCouch tables instead of /my-tenants API","description":"Currently Roady relies on /my-tenants API endpoint which fails when MyCouch is down. Instead, tenant/band data should be readable directly from MyCouch as regular tables (filtered by user), allowing offline-first access to band list and metadata. This would eliminate the hard dependency on API endpoints for basic offline functionality.","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-09T22:59:26.8163935-08:00","updated_at":"2025-12-09T23:00:32.8266304-08:00"}
